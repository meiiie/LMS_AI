======================================================================
P3 SOTA STREAMING VERIFICATION
Date: 2025-12-21 02:48:25
Target: https://maritime-ai-chatbot.onrender.com
======================================================================

âš ï¸  Using SAME test questions as test_production_api.py for fair comparison
======================================================================
P3 SOTA STREAMING TEST - /api/v1/chat/stream/v2
======================================================================

======================================================================
TEST 1/2: Äiá»u 50 - Quyá»n háº¡n thuyá»n trÆ°á»Ÿng (same as production_api.py)
======================================================================

ğŸ“¤ Request: Giáº£i thÃ­ch Äiá»u 50 vá» quyá»n háº¡n cá»§a thuyá»n trÆ°á»Ÿng trÃªn tÃ u biá»ƒn theo Bá»™ luáº­t hÃ ng háº£i Viá»‡t Nam 2015.
----------------------------------------------------------------------
Status: 200
Content-Type: text/event-stream; charset=utf-8
----------------------------------------------------------------------

ğŸ“¨ Events received:

   ğŸ”„ thinking: {"content": "ğŸ¯ Äang phÃ¢n tÃ­ch cÃ¢u há»i..."}...
   ğŸ”„ thinking: {"content": "ğŸ” Äang tra cá»©u cÆ¡ sá»Ÿ dá»¯ liá»‡u..."}...
   ğŸ”„ thinking: {"content": "ğŸ“š TÃ¬m tháº¥y 10 tÃ i liá»‡u liÃªn quan"}...
   ğŸ”„ thinking: {"content": "âœï¸ Äang táº¡o cÃ¢u tráº£ lá»i..."}...

   âš¡ FIRST TOKEN TIME: 23.85s
----------------------------------------------------------------------
   ğŸ“ answer token #1: {"content": "<thinking>\nNgÆ°á»i dÃ¹ng muá»‘n giáº£i thÃ­ch vá» Äiá»u 50 cá»§a Bá»™ luáº­t HÃ ng ...
   ğŸ“ answer token #2: {"content": " tra cá»©u (RAG):\n- **Äiá»u 50** quy Ä‘á»‹nh vá» **Thuyá»n bá»™** (Ä‘"}...
   ğŸ“ answer token #3: {"content": "á»‹nh nghÄ©a cÃ¡c thÃ nh pháº§n trÃªn tÃ u).\n- **Äiá»u 52** nÃ³i vá» **Äá»‹a vá»‹ ...
   ğŸ“ answer token #4: {"content": " thuyá»n trÆ°á»Ÿng**.\n- **Äiá»u 54** má»›i lÃ  Ä‘iá»u quy Ä‘á»‹nh vá» **Quyá»n cá»§...
   ğŸ“ answer token #5: {"content": "áº¿ hoáº¡ch:\n1. ÄÃ­nh chÃ­nh nháº¹ nhÃ ng ráº±ng Äiá»u 50 táº­p trung vÃ o Ä‘á»‹nh n...
   ğŸ“ ... (streaming more tokens)
   ğŸ“š sources: 10 sources received
   ğŸ“Š metadata: {"processing_time": 27.627, "model": "maritime-rag-v1", "agent_type": "rag", "streaming_version": "v...
   âœ… done

======================================================================
TEST RESULTS
======================================================================
   Question:        Giáº£i thÃ­ch Äiá»u 50 vá» quyá»n háº¡n cá»§a thuyá»n trÆ°á»Ÿng trÃªn tÃ u b...
   Total tokens:    33
   Answer length:   3166 chars
   Thinking events: 4
   First token:     23.85s
   Total time:      28.39s
   Sources:         10
   Error:           None

   ğŸ“ FULL ANSWER PREVIEW (first 500 chars):
----------------------------------------------------------------------
   <thinking>
   NgÆ°á»i dÃ¹ng muá»‘n giáº£i thÃ­ch vá» Äiá»u 50 cá»§a Bá»™ luáº­t HÃ ng háº£i Viá»‡t Nam 2015, nhÆ°ng láº¡i gáº¯n nÃ³ vá»›i ná»™i dung "quyá»n háº¡n cá»§a thuyá»n trÆ°á»Ÿng". 
   Qua kiá»ƒm tra ná»™i dung tra cá»©u (RAG):
   - **Äiá»u 50** quy Ä‘á»‹nh vá» **Thuyá»n bá»™** (Ä‘á»‹nh nghÄ©a cÃ¡c thÃ nh pháº§n trÃªn tÃ u).
   - **Äiá»u 52** nÃ³i vá» **Äá»‹a vá»‹ phÃ¡p lÃ½ cá»§a thuyá»n trÆ°á»Ÿng**.
   - **Äiá»u 54** má»›i lÃ  Ä‘iá»u quy Ä‘á»‹nh vá» **Quyá»n cá»§a thuyá»n trÆ°á»Ÿng**.
   
   Káº¿ hoáº¡ch:
   1. ÄÃ­nh chÃ­nh nháº¹ nhÃ ng ráº±ng Äiá»u 50 táº­p trung vÃ o Ä‘á»‹nh nghÄ©a "Thuyá»n bá»™", trong Ä‘Ã³ Thuyá»n trÆ°á»Ÿng lÃ  
   ... (2666 more chars)

======================================================================
TEST 2/2: Rule 15 COLREGs - Crossing situation
======================================================================

ğŸ“¤ Request: Quy táº¯c 15 COLREGs quy Ä‘á»‹nh tháº¿ nÃ o vá» tÃ¬nh huá»‘ng cáº¯t mÅ©i nhau?
----------------------------------------------------------------------
Status: 200
Content-Type: text/event-stream; charset=utf-8
----------------------------------------------------------------------

ğŸ“¨ Events received:

   ğŸ”„ thinking: {"content": "ğŸ¯ Äang phÃ¢n tÃ­ch cÃ¢u há»i..."}...
   ğŸ”„ thinking: {"content": "ğŸ” Äang tra cá»©u cÆ¡ sá»Ÿ dá»¯ liá»‡u..."}...
   ğŸ”„ thinking: {"content": "ğŸ“š TÃ¬m tháº¥y 10 tÃ i liá»‡u liÃªn quan"}...
   ğŸ”„ thinking: {"content": "âœï¸ Äang táº¡o cÃ¢u tráº£ lá»i..."}...

   âš¡ FIRST TOKEN TIME: 22.47s
----------------------------------------------------------------------
   ğŸ“ answer token #1: {"content": "<thinking>\nNgÆ°á»i dÃ¹ng há»i vá» Quy táº¯c 15 cá»§a COLREGs (CÃ´ng Æ°á»›c quá»‘c...
   ğŸ“ answer token #2: {"content": "áº¯t mÅ©i nhau). \nTrong pháº§n dá»¯ liá»‡u RAG cung cáº¥p, \"Äiá»u 15\" láº¡i Ä‘a...
   ğŸ“ answer token #3: {"content": " vá» \"Chá»§ tÃ u\" trong Bá»™ luáº­t HÃ ng háº£i Viá»‡t Nam, khÃ´ng pháº£i Quy táº¯c...
   ğŸ“ answer token #4: {"content": " \nDo Ä‘Ã³, tÃ´i cáº§n sá»­ dá»¥ng cÃ´ng cá»¥ tÃ¬m kiáº¿m Ä‘á»ƒ láº¥y chÃ­nh xÃ¡c ná»™i dun...
   ğŸ“ answer token #5: {"content": "s nháº±m cung cáº¥p thÃ´ng tin chuáº©n xÃ¡c nháº¥t cho ngÆ°á»i dÃ¹ng. \nBÃªn cáº¡nh...
   ğŸ“ ... (streaming more tokens)
   ğŸ“š sources: 10 sources received
   ğŸ“Š metadata: {"processing_time": 22.952, "model": "maritime-rag-v1", "agent_type": "rag", "streaming_version": "v...
   âœ… done

======================================================================
TEST RESULTS
======================================================================
   Question:        Quy táº¯c 15 COLREGs quy Ä‘á»‹nh tháº¿ nÃ o vá» tÃ¬nh huá»‘ng cáº¯t mÅ©i nh...
   Total tokens:    7
   Answer length:   783 chars
   Thinking events: 4
   First token:     22.47s
   Total time:      23.38s
   Sources:         10
   Error:           None

   ğŸ“ FULL ANSWER PREVIEW (first 500 chars):
----------------------------------------------------------------------
   <thinking>
   NgÆ°á»i dÃ¹ng há»i vá» Quy táº¯c 15 cá»§a COLREGs (CÃ´ng Æ°á»›c quá»‘c táº¿ vá» phÃ²ng ngá»«a Ä‘Ã¢m va trÃªn biá»ƒn) liÃªn quan Ä‘áº¿n tÃ¬nh huá»‘ng cáº¯t hÆ°á»›ng (cáº¯t mÅ©i nhau). 
   Trong pháº§n dá»¯ liá»‡u RAG cung cáº¥p, "Äiá»u 15" láº¡i Ä‘ang nÃ³i vá» "Chá»§ tÃ u" trong Bá»™ luáº­t HÃ ng háº£i Viá»‡t Nam, khÃ´ng pháº£i Quy táº¯c 15 cá»§a COLREGs. 
   Do Ä‘Ã³, tÃ´i cáº§n sá»­ dá»¥ng cÃ´ng cá»¥ tÃ¬m kiáº¿m Ä‘á»ƒ láº¥y chÃ­nh xÃ¡c ná»™i dung Quy táº¯c 15 COLREGs nháº±m cung cáº¥p thÃ´ng tin chuáº©n xÃ¡c nháº¥t cho ngÆ°á»i dÃ¹ng. 
   BÃªn cáº¡nh Ä‘Ã³, tÃ´i sáº½ kiá»ƒm tra thÃ´ng tin ngÆ°á»i dÃ¹ng Ä‘á»ƒ xÆ°ng hÃ´ thÃ¢n m
   ... (283 more chars)




======================================================================
V1 (production /chat) vs V2 (streaming) COMPARISON
======================================================================

ğŸ“¡ Testing V1 (/api/v1/chat - non-streaming)...
   âœ… V1 Success: 2749 chars, 5 sources in 52.90s

ğŸ“¡ Testing V2 (/api/v1/chat/stream/v2 - streaming)...
   âœ… V2 Success: 3598 chars, 10 sources
      First token: 16.21s, Total: 20.63s

======================================================================
COMPARISON RESULTS
======================================================================
| Metric        | V1 (/chat)    | V2 (/stream/v2) | Difference     |
|---------------|---------------|-----------------|----------------|
| First visible | 52.90s (all)   | 16.21s (token) | 3.3x faster    |
| Total time    | 52.90s        | 20.63s          | Different        |
| Answer length | 2749 chars   | 3598 chars      | DIFFERENT!        |
| Sources       | 5            | 10              | Different            |

======================================================================
FINAL SUMMARY
======================================================================
   Tests passed:     2/2
   Avg first token:  23.16s
   Target:           <40s
   Avg answer len:   1974 chars

âœ… ALL TESTS PASSED - P3 STREAMING WORKING!

======================================================================